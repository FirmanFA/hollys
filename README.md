## Kelompok 4:
- FIRMANSYAH FIRDAUS ANHAR (19081010031)
- SURYA ROSAULI PASARIBU (19081010122)
- EKA ZUNI SELVIANA (19081010026)
- GAGAS TARUNA PAMUNGKAS (19081010114)
- ALDOFINO PRANAYUBI (19081010126)

# Website Pemesanan Makanan Holly’s
**![](https://lh4.googleusercontent.com/G_Y0RSck67Y9GXnokZWG_nBdOj4X-DpcZx5Lnj90XtZYRP1MdeailbMZaTe19HomrHnoqvaN-OYn6uq_Q5eHKv_TZSlo44oflCAs-MlXhF35weWqoKfCsg-dPXcGT6pqa0lLIqwA)**
## Deskripsi Aplikasi
Website Pemesan Makanan ini dibuat dengan tujuan untuk memudahkan pembeli atau pelanggan makanan dalam melakukan pemesanan makanan di restoran. Restoran ini diberi nama _Holly's_. Dengan adanya website ini diharapkan dari sisi pelanggan bisa untuk mempermudah melihat menu yang ada pada restoran Holly's serta memudahkan keputusan dalam melakukan pemesanan makanan. Dari sisi pemilik restoran ataupun pelayannya, diharapkan bisa mempermudah juga dalam menunjukkan menu restoran.

## Sitemap
**![](https://lh3.googleusercontent.com/mn-A9X1VrZIS8BUJZpcn6T4wCrnO2_VfNQAhRZhxgLTUjx_4p2EUQx0uQtFu6Zc5Jmfqo30gAgcyjz7sQbWjwc6EJhdeQnmKC-yQ1SJfe9KAqKZCJnD-6SNMaCs47V3GCAEv60cI)**

### Penjelasan Sitemap User
- User dapat melihat menu yang terkategori atas makanan, minuman, dan camilan.
- User dapat melihat profil dan mengedit profil.
- User dapat menambahkan item pesanan ke keranjang pesanan dan melakukan checkout.

### Penjelasan Sitemap Admin
- Admin dapat melihat daftar menu yang sudah ditambahkan pada menu overview.
- Admin dapat menambah menu pada add menu.
- Admin dapat mengedit menu yang telah ditambahkan pada edit menu.
- Admin dapat melihat daftar pesanan yang diterima pada menu orders overview.
- Admin dapat mengupdate status pesanan pada menu update order status.

## Teknologi Yang Digunakan
Teknologi yang digunakan dalam pembuatan website pemesanan makanan Holly’s di antaranya seperti html, css, javascript, bootstrap, php, dan framework codeigniter3.
Html, css, javaScript dan bootstrap digunakan untuk melakukan desain website pemesanan makanan Holly's. Untuk bahasa pemrograman yang digunakan adalah bahasa pemrograman PHP. Dan dalam pengerjaan source code dilakukan sesuai dengan kerangka kerja codeigniter3.


## Cara Penggunaan Aplikasi
### Menggunakan Website dari Sisi Client
1.  Pengguna dapat berkunjung ke halaman localhost/hollysss untuk melakukan register (jika belum memiliki akun) atau login (jika sudah memiliki akun).
    
2.  Untuk register, pengguna perlu memasukkan data diri yang diminta sebagai berikut, Nama Depan, Nama Belakang, Email, Kata Sandi, Mengetik Ulang Kata Sandi, Nomor HP, dan Alamat

3.  Setelah melakukan register, akan muncul pemberitahuan bahwa akun pengguna telah berhasil dibuat dan mengarah langsung pada halaman login.
    
4.  Untuk login, pengguna perlu memasukkan email dan password yang telah didaftarkan tadi. Jika data tidak valid atau terdapat kesalahan, maka akan muncul pemberitahuan. Jika data valid, maka pengguna bisa langsung menuju ke halaman index.
    
5.  Saat berada di halaman index, terdapat fitur-fitur yang dapat diakses oleh pengguna. Pada bagian header, terdapat fitur keranjang, akun pengguna, dan log out. Pada bagian body, terdapat fitur melihat menu apa saja yang ada di restoran.

6. Jika ingin pesan menu, pengguna dapat meng-klik “Lihat Menu”.
    
7.  Pengguna diarahkan ke halaman yang berisikan menu-menu yang sesuai kategori. Kategori dibagi menjadi tiga, yaitu makanan, minuman, dan camilan.
    
8.  Pengguna dapat meng-klik salah satu menu dan akan diarahkan ke halaman pesan. Di halaman pesan, pengguna dapat melihat gambar makanan yang akan dipesan serta memasukkan berapa jumlah atau kuantitas makanan yang akan dibeli sesuai dengan kebutuhan. Setelah itu, pengguna dapat menekan tombol pesan.

9. Pengguna akan diarahkan ke halaman pesanan saya. Di halaman tersebut, pengguna dapat melihat pesanannya, gambar pesanan, jumlah pesanan, harga yang harus dibayar, melakukan check-out pesanan atau menghapus pesanan yang ada.
    
10.  Jika melakukan delete pada item pesanan, maka item tersebut akan terhapus dan akan tampil bahwa pengguna belum melakukan pesanan.
    
11.  Jika melakukan check-out, maka pengguna akan mendapat notifikasi bahwa pesanan akan disiapkan restoran.
    
12.  Dalam fitur “profile”, pengguna dapat melihat profil dan melakukan edit data serta menyimpan perubahan.
    
13.  Dalam fitur “logout”, pengguna dapat log-out dari website.

### Menggunakan Website dari Sisi Admin
1. Terdapat dua jenis admin, yaitu admin dan superadmin.
    
2.  Admin dan superadmin login menggunakan metode yang sama dengan member. Jika akun mereka terdeteksi sebagai akun admin, maka sistem akan me-redirect mereka ke halaman admin.
    
3.  Admin dapat me-manage menu dan pesanan. Superadmin memiliki hak yang sama dengan admin, dengan tambahan hak untuk menambah dan menghapus admin baru.
    
4.  Untuk mengolah data admin, superadmin dapat navigasi ke halaman Manage Admin.
    
5.  Untuk menambah admin baru, superadmin dapat mengklik tombol Tambah Admin, lalu mengisi form dengan data yang sesuai.
    
6.  Untuk mengolah data menu, admin dapat navigasi ke halaman Menu.
    
7.  Untuk menambah menu, admin dapat mengklik tombol Tambah Menu, lalu mengisi form dengan data yang sesuai.
    
8.  Untuk mengedit menu, admin dapat mengklik tombol Edit Menu, lalu mengubah data form dengan data baru.
    
9.  Saat admin mengklik tombol hapus, maka item tersebut akan terhapus dan tidak akan tampil di sisi client.
    
10.  Admin dapat memperbarui status pesanan dengan menavigasi ke halaman Manage Orders kemudian mengklik tombol update.
    
11.  Admin dapat memilih salah satu dari sejumlah pilihan. Pilihan yang tersedia adalah paid, unpaid, dan cancelled.

## Fitur-Fitur Yang Ditawarkan Beserta Screenshot Program
### Client
Dari sisi client, fitur website pemesanan makanan yang ditawarkan beserta dengan gambaran screenshot web-nya adalah sebagai berikut :

1.  Pengguna dapat melihat tampilan awal website yang berisi register atau login.**![](https://lh6.googleusercontent.com/aDqQFJuo-WGdB-ObM1Mef0cAJ0c9MB2_0M9_O9OOKcVmwhsx9ekoyTTq1yXN8C-O56uy-oVOsv7hSN4d9C0awUH2Xb8N5cTwipHzI8EcaaDrmZiP4ZVfr5h5Zh9w7fpttiLH2b8e)**
2. Pengguna dapat melakukan register (pendaftaran) akun.**![](https://lh6.googleusercontent.com/3Fe664hfDxyNvEHqV8mkQohlrPfklSjCPK82vY8nDBEjwqdJu4gGiSDfbZCR33wg710jTWPPcpkeejBTOXBWlOQOH4nqo15AoOgV-ZwsYbXODpzc9yhiGU8kD5aq109ZMiHW8aS-)**
3. Pengguna dapat secara langsung melakukan login sesuai dengan email dan password yang didaftarkan saat melakukan register.**![](https://lh4.googleusercontent.com/HVbAMplPttmiBBwBh9g24HuEWSke9kKjN1DheOxMbH63zPavE_8cW5_VelH3LA-7ueusvS3Owf4w17pe3oDMxmgj1coHxH9GWM3EBqId6Oz0qD25DofGuAzzAG6MRiYQoju7a7rS)**
4. Pengguna dapat melakukan pemesanan sesuai dengan kategori pemesanan yang diinginkan. Terdapat 3 kategori yaitu makanan, minuman, dan camilan.**![](https://lh3.googleusercontent.com/V6XGZ9HvoTpbHxsfLzQvw2daLC_o5F2AyDrOQ3BuplEkBcAeYJfhV8EG6bcRDkVTuHoO7KN5jo51EV3cl0M4bwigOHFj7AmhQkID4vu6y38-2gA6cLsjL9m5SnpRS_SLPLoRy643)**
5. Berikut merupakan tampilan menu search.**![](https://lh4.googleusercontent.com/7XqTSvnRCy6_V-Yim_2aU6P84PptDXzIf5-1mdX16inZZnk0Yv5urPs7C-6eLS4m9YcYoIc-rIZnh7iZla8RIYWVA3lJ6LwlyTQJQ3yF98Q0XDjNRKqqzAtuIkPAfOAQert7WzrF)**
6. Berikut merupakan tampilan menu pemesanan makanan. Pengguna dapat memilih menu makanan yang ingin dipesan.**![](https://lh4.googleusercontent.com/vJs9GTCeRr_e5ia6vEijyAba50-RHlg-YOHXG6VRNVodIK2fyFGw7vxj5oNP6Gbw_Kcgog5-FUuKorWXimZYTfGwKRRBdmlKgZWk5shRGFDiTZVIiD1kfDqeboY1_o8pYvMEN84s)**
7. Berikut merupakan tampilan menu pemesanan minuman. Pengguna dapat memilih menu minuman yang ingin dipesan.**![](https://lh6.googleusercontent.com/T5JsP5Ihwoy_HZvT4TKqQOhQ0HhiXKZMO9zQsCrHUYEzM2pb7ewSZrLNwthXwCyWhr_1bmghIMPQY7UL-Idd2iaCV9ffnpv2DMY8RcUorvzyl3VgeuPr8xZip-9WhcJKr3xntIe3)**
8. Berikut merupakan tampilan menu pemesanan camilan. Pengguna dapat memilih menu camilan yang ingin dipesan.**![](https://lh3.googleusercontent.com/nZtE7lBzoDnrzZNpMEGx5sO8mkNqjZrSiS1xvmENY6cwGQV2f4F4eo3ZQy47zSuuSceAG1b3gsTcSEMVTqO0t3XQEG4uZ3o3T4hQGjec0KqY-d_pqFsqNivDOav-kpMKYyrGDR3E)**
9. Pada tampilan ini pengguna dapat memasukkan jumlah menu yang ingin dipesan.**![](https://lh5.googleusercontent.com/loQNBRHGKF9c8Vfycal-xciUUU9IYusgFZYBZXJAbsKvt8Wju8rMJlHhOMellBRApsTUfkc5js-uSUb69CLDZHpLmrWC_f9FpYwdpyuEUr0w5AvVPrr9VnZOS2syaOKW8PlV-56f)**
10.  Berikut merupakan tampilan keranjang pemesanan. Disini kita bisa melihat menu menu yang telah kita pesan dan juga bisa melakukan checkout sehingga pemesanan akan segera diproses.**![](https://lh3.googleusercontent.com/7sCLr5BwdSjLv-olc8oapAlFqzset4jf0Wq_9WI-J3HEeqjx960KOoW6g-zDCeFx8iPpwLZUPTpIAbbQRpixxyP1LL3P7MbuU6WtaCD5p1j7GSdfQetej9_vyaXLTAHue7bBLsLj)**
11. Berikut merupakan tampilan setelah pengguna melakukan checkout. Terdapat tulisan “Pesanan anda diproses!”**![](https://lh4.googleusercontent.com/PFfSAv6E1KpwOVjhe2NZUnDmX48l7AwxOqUmOYzIRaswcuzo8hYOWec86d8ColNBLrmdjC8FDMfcAb1hNYdXIlkG_0KA1jYv7M0dWCcTZLhCiVBLYOevjnLCOZ8V3aDSwpOD2je5)**
12. Berikut adalah tampilan ketika pengguna logout dari website.**![](https://lh5.googleusercontent.com/DZUfP-sFwCVeNX1gvunol4rNqrMMW7___CK-LILZ7cpc7baZjbR481A78GVOc8h1pjVNMN-8Ioq3SIHSCUqRauyC7I5Ho1XXrUUQuST6wv-JzZ63X1Icolsefi2KHCWemuSkJlut)**
### Admin
Dari sisi client, fitur website pemesanan makanan yang ditawarkan beserta dengan gambaran screenshot web-nya adalah sebagai berikut :
1.  Pengguna dapat melihat data menu.**![](https://lh6.googleusercontent.com/8oXKG1d0UFrOfM9KGj_a-iCZWKNbOYsFSynni0rgOPemdWEYb4GtDTAME1NYGeEWnqWJiuVMbP2ohsoblIVdQe_AP7Yj5cfoPD2O1L0C2EJ9nWEDisDuGTTx4vjzdcmJ_kYmp6kI)**
2. Pengguna dapat melakukan insert data menu.**![](https://lh4.googleusercontent.com/WhrgrcL2CKEQFjjTkUIB6WaqL_MspzYMwaOemQxRvbj925C2EtxFMnId2Hpu16e789zKyW_6VSv62u-ICU-LdYhty7ROTMyKSB7GEyeDbAVh7nvtDJr2LzM3lXSnje-7DGDAaBpF)**
3. Pengguna dapat mengubah data menu yang ada.**![](https://lh6.googleusercontent.com/aOLOV90C7Kq6wOYreHYYRtyyvJ5-NKt5uGuBD1KNIVYeUyhr_YvNIeUwQK_XoCX97uKoQ8lIcFNMrtw8U3V1gprpC5MxNI33lTDvUw7OHCDWwkHKZuHCso225F27AhQl9teBFo6z)**
4. Pengguna dapat melihat penjualan.**![](https://lh3.googleusercontent.com/c_WGeXHHK-DyIKoo8QUYYrfZt2gEDGeLrHy1GJMo0tYfJxl6i4vF2TCu2qELfo5I-tsZyFauoUv2puDGAvqjtv8v_tNPF86YMKltlCzGqNR3ts-7RltwxO7eCZH-fpu35BnBFYQF)**
5. Pengguna bisa mengubah data penjualan sesuai keadaan.**![](https://lh4.googleusercontent.com/s8yntDwUJfbJhUlq7UceardR53O7_cFIxj66w5KZrIEUhUjJTlbAShRPM38XhCq2CkbqqJWUT-Rf3sYUw_M2r4FOTNK-cXoGkslny0jS2I-OMGtmixvPF-2NAQaeAfhn_d9JtWk3)**
6. Pengguna bisa melihat detail order dari masing masing order.**![](https://lh3.googleusercontent.com/c0UpR5PLkm9CCUIlIXRWy4Lpi4IkcZEXCncVXb9vXLMWXY-IwHTFWivt6RpwG5Dogrz8OM-2_3G-VTGpgRuMxZagXgQ9ymiHmbfCf5v__1BunLVpYwzA0y_fV6ja7rBhnoNnChv8)**
7. Pengguna yang merupakan superadmin dapat melihat data user.**![](https://lh5.googleusercontent.com/XXGuqSaH4Jn_OHxJeFMcNOWM8PUmT439D6w2T5RJnXQDzoRPd_ogTA3fPdCAFqiXEVCWXJckZt3wJDcAZW_XRLJPaJnyZRV4mLC8CeP9nqXlTaGgEEp1W-QKgUnx_7ax0Ee_jv_H)**
8. Super admin juga dapat menambahkan admin baru.**![](https://lh3.googleusercontent.com/GljMwZAP116waGm_K0k8mA5pF02OLcEF6vfZti1xLrpbIilhLNMEoFiRR9LP6IRYO_bEAQOkjse1y2WBh525XauA14BVvWVqE64owhClDr9MoroJaiPtZdgG34TAMxQjBOBRw-l_)**
9. juga bisa mengubah datanya.**![](https://lh4.googleusercontent.com/y-UMqcuzrNx7CHNZnZtpLwt36xLhJTph0Vw2z29HBTnX218GUkrYFChdbN1ELYn4zbE8mlZFpkgsUpFALS7JUGkj2soOhNXd9x8lpWT83HheN-CsH3ndnSVAbO-mF1hPBiCPpA7O)**
10. Penguna bisa melakukan logout seperti berikut.**![](https://lh4.googleusercontent.com/ZVcb_s8LCNYhEndy4RTGplQsQKYJ4wed67Cdpn0sJCKrx8EZvyYwfo3O8eW4bxmG69Eqp_6prJHJ7rNhAWBMh8oeqFsDIMweIoHUrGmizjZWcP5Ol6vP0_p4Pbkw0o0Sl8dczW3o)**



## Kode-Kode Inti Beserta Penjelasannya
### Kode Inti Untuk Sisi Client
#### 1.  class Auth
Controller Auth digunakan untuk melakukan authentication.

Berikut kode inti-nya:
    public function __construct()
    {
        parent::__construct();
        // digunakan me-load library form_validation
        $this->load->library('form_validation');
        $this->load->helper('cookie');
    }

**digunakan untuk menampilkan halaman index.**
    public function index()

    {

        // membuat agar user tidak kembali ke halaman login setelah melakukan login tanpa logout

        if ($this->session->userdata('email')) {

            redirect('users');

        }

  

    $this->form_validation->set_rules('email', 'Email', 'trim|required|valid_email');

    $this->form_validation->set_rules('password', 'Password', 'trim|required');

  

    // jika gagal login, maka berikan pesan gagal

    if ($this->form_validation->run() == false) {

        $data['title'] = 'Login Page';

        $this->load->view('templates/auth_header', $data);

        $this->load->view('auth/login');

        $this->load->view('templates/auth_footer');

    }

    // menjalankan halaman login

    else {

        // method _login() bersifat private.

        $this->_login(); // di arahkan ke method login agar baris kode tidak panjang2.

    }

}

**digunakan untuk membuat pengguna dapat login dan masuk ke halaman index.**
    private function _login()

    {

        // simpan data yang dikirim dari form ke dalam variabel email dan password

        $email = $this->input->post('email');

        $password = $this->input->post('password');

        

        // memeriksa apakah data user terdapat di dalam database atau tidak

        // SELECT * FROM users where email = $email

        $users = $this->db->get_where('users', ['email' => $email])->row_array();

        

        // jika data user ada di database, loginkan user ke halaman home/index

        if ($users) {

        // jika usernya aktif

        if ($users['is_active'] == 1) {

        // cek password dulu, kalau benar maka kode di bawah akan dijalankan

        if (password_verify($password, $users['password'])) {

        $cookie = array(

        

        'name' => 'user_id',

        'value' => $users['id'],

        'expire' => '604800',

        'secure' => TRUE

        

        );

        

        $this->input->set_cookie($cookie);

        // kalau passwordnya benar, kita cek email dan role nya (apakah admin atau member)

        $data = [

        'email' => $users['email'],

        'role_id' => $users['role_id']

        ];

        // set user data-nya

        $this->session->set_userdata($data);

        // kalau member, arahkan ke controller member

        redirect('users');

        }

        // jika password salah

        else {

        // berikan pesan gagal login karena password salah

        $this->session->set_flashdata(

        'message',

        '<div class="alert alert-danger" role="alert">

        Password Anda salah!

        </div>'

        );

        redirect('auth');

        }

        }

        // jika user tidak aktif

        else {

        // berikan pesan gagal login karena data tidak ada di database.

        $this->session->set_flashdata(

        'message',

        '<div class="alert alert-danger" role="alert">

        Email Anda belum aktif!

        </div>'

        );

        redirect('auth');

        }

        }

        // jika tidak ada di database, user tidak boleh login.

        else {

        // berikan pesan gagal login karena data tidak ada di database.

        $this->session->set_flashdata(

        'message',

        '<div class="alert alert-danger" role="alert">

        Email Anda belum terdaftar!

        </div>'

        );

        redirect('auth');

        }

    }

**digunakan untuk melakukan register.**
    public function register()

    {

    // membuat rules untuk form validation agar register bisa dilakukan

    // kotak inputan register tidak boleh kosong

    $this->form_validation->set_rules('namadepan', 'Nama Depan', 'required|trim');

    $this->form_validation->set_rules('namabelakang', 'Nama Belakang', 'required|trim');

    $this->form_validation->set_rules(

    'email',

    'Email',

    'required|trim|valid_email|is_unique[users.email]',

    ['email' => 'Email sudah terdaftar.']

    );

    $this->form_validation->set_rules(

    'password1',

    'Password',

    'required|trim|min_length[3]|matches[password2]',

    [

    'matches' => 'Kata Sandi tidak sama.',

    'min_length' => 'Kata Sandi terlalu pendek'

    ]

    );

    $this->form_validation->set_rules('password2', 'Password', 'required|trim|matches[password1]');

    

    if ($this->form_validation->run() == false) { // jika register gagal, tampilkan kembali halaman register

    $data['title'] = 'User Registration';

    $this->load->view('templates/auth_header', $data);

    $this->load->view('auth/register');

    $this->load->view('templates/auth_footer');

    } else {

    // ambil data dari form, masukkan ke database

    $data = [

    'namadepan' => htmlspecialchars($this->input->post('namadepan', true)),

    'namabelakang' => htmlspecialchars($this->input->post('namabelakang', true)),

    'email' => htmlspecialchars($this->input->post('email', true)),

    'image' => 'default.jpg',

    'password' => password_hash($this->input->post('password1'), PASSWORD_DEFAULT),

    'nohp' => htmlspecialchars($this->input->post('nohp', true)),

    'alamat' => htmlspecialchars($this->input->post('alamat', true)),

    'role_id' => '2',

    'is_active' => '1',

    'created_at' => time()

    ];

    

    // insert ke database table

    $this->db->insert('users', $data);

    // membuat pesan berhasil melakukan register

    $this->session->set_flashdata(

    'message',

    '<div class="alert alert-success" role="alert">

    Akun Anda berhasil dibuat. Silakan melakukan login.

    </div>'

    );

    // redirect ke auth login page setelah melakukan register

    redirect('auth');

    }

    }

**digunakan untuk melakukan log-out.**
    public function logout()

    {

    // membersihkan session dan mengembalikan ke halaman login

    $this->session->unset_userdata('email');

    $this->session->unset_userdata('role_id');

    

    $this->session->set_flashdata(

    'message',

    '<div class="alert alert-success" role="alert">

    Anda berhasil Logout.

    </div>'

    );

    // redirect ke auth login page setelah melakukan logout

    redirect('auth');

    }


#### 2.  class Cart
**digunakan untuk me-load model yang dibutuhkan untuk menjalankan cart.**
    public function __construct()
    {
    parent::__construct();
    $this->load->model('M_Cart');
    $this->load->model('M_Menu');
    $this->load->model('M_Order');
    $this->load->model('M_Order_Detail');
    }

**digunakan untuk menjalankan index saat memilih fitur cart.**
    public function index()

    {

    $user_id = $this->input->cookie('user_id', true);

    

    $orders = $this->M_Order->getOrder($user_id, 'unpaid');

    if ($orders) {

    $order_details = $this->M_Order->getOrderDetails($orders[0]->id);

    $dataOrders = array();

    for ($i=0; $i < count($order_details); $i++) {

    $dataMenuOrder = $this->M_Order->getOrderDetail($order_details[$i]->id);

    $dataOrders[] = $dataMenuOrder[0];

    }

    $arrayMenu = array(

    'order' => $orders,

    'dataOrders' => $dataOrders

    );

    

    $data['title'] = 'Cart';

    $this->load->view('templates/header_user', $data);

    $this->load->view('cart/index', $arrayMenu);

    } else {

    $orders = [];

    $dataOrders = [];

    $arrayMenu = array(

    'order' => $orders,

    'dataOrders' => $dataOrders

    );

    

    $data['title'] = 'Cart';

    $this->load->view('templates/header_user', $data);

    $this->load->view('cart/index', $arrayMenu);

    }

    

    }

**digunakan agar pengguna dapat menambahkan item pesanan ke keranjang**
    public function add($id)

    {

    $menu = $this->M_Menu->getMenu($id);

    

    $arrayMenu = array(

    'menu' => $menu

    );

    $data['title'] = 'Create Order';

    $this->load->view('templates/header_user', $data);

    $this->load->view('cart/add', $arrayMenu);

    }

**digunakan agar pengguna dapat membuat orderannya dan menampilkan pesanan pengguna.**
    public function create($id)

    {

    $user_id = $this->input->cookie('user_id', true);

    

    // ambil menu berdasarkan id

    $menu = $this->M_Menu->getMenu($id);

    

    // ambil data form input

    $qty = $this->input->post('qty');

    $price = $menu[0]->price;

    

    // ini ambil order berdasar user id dan status order unpaid

    $order = $this->M_Order->getOrder($user_id, 'unpaid');

    

    // check order where user id and status unpaid

    if (count($order) == 0) {

    // bikin data order

    $arrInsertOrder = array(

    'user_id' => $user_id,

    'status' => 'unpaid',

    'sub_total' => $qty * $price,

    'created_at' => date("Y/m/d"),

    'updated_at' => date("Y/m/d"),

    );

    

    $this->db->insert('orders', $arrInsertOrder);

    // get order id

    $newOrder = $this->M_Order->getOrder($user_id, 'unpaid');

    

    // bikin data order detail

    $arrInsertOrderDetails = array(

    'order_id' => $newOrder[0]->id,

    'menu_id' => $id,

    'qty' => $qty,

    'price' => $qty * $price,

    'created_at' => date("Y/m/d"),

    'updated_at' => date("Y/m/d"),

    );

    

    $this->db->insert('order_details', $arrInsertOrderDetails);

    } else {

    // get order detail where order id and menu id

    $orderDetail = $this->M_Order_Detail->getOrderDetail($order[0]->id, $id);

    

    // cek apakah ada data order detail dengan order id dan menu id

    if (count($orderDetail) == 0) {

    // bikin data order detail

    $arrInsertOrderDetails = array(

    'order_id' => $order[0]->id,

    'menu_id' => $id,

    'qty' => $qty,

    'price' => $qty * $price,

    'created_at' => date("Y/m/d"),

    'updated_at' => date("Y/m/d"),

    );

    

    $this->db->insert('order_details', $arrInsertOrderDetails);

    

    // update data order ( sub total sama updated at )

    $arrUpdateOrder = array(

    'sub_total' => $order[0]->sub_total + ($qty * $price),

    'updated_at' => date("Y/m/d")

    );

    

    $this->db->update('orders', $arrUpdateOrder, array('id' => $order[0]->id));

    } else {

    // update exists menu order detail

    $arrUpdateOrderDetails = array(

    'qty' => $orderDetail[0]->qty + $qty,

    'price' => $orderDetail[0]->price + ($qty * $price),

    'updated_at' => date("Y/m/d"),

    );

    

    $this->db->update('order_details', $arrUpdateOrderDetails, array('menu_id' => $orderDetail[0]->menu_id));

    

    // update data order ( sub total sama updated at )

    $arrUpdateOrder = array(

    'sub_total' => $order[0]->sub_total + ($qty * $price),

    'updated_at' => date("Y/m/d")

    );

    

    $this->db->update('orders', $arrUpdateOrder, array('id' => $order[0]->id));

    }

    }

    

    redirect(base_url().'cart');

    }

**digunakan untuk menghapus item pesanan pengguna.**
    public function delete($id)

    {

    $order_details = $this->M_Order->getOrderDetail($id);

    $orders = $this->M_Order->getOrderWhereId($order_details[0]->order_id);

    

    $arrUpdateOrder = array(

    'sub_total' => $orders[0]->sub_total - $order_details[0]->price,

    'updated_at' => date("Y/m/d")

    );

    

    $this->db->update('orders', $arrUpdateOrder, array('id' => $order_details[0]->order_id));

    $this->db->delete('order_details', array('id' => $id));

    

    redirect(base_url().'cart');

    }

**digunakan untuk melakukan check-out pesanan pengguna.**
    public function checkout($id)

    {

    $arrUpdateOrder = array(

    'status' => 'paid',

    'updated_at' => date("Y/m/d")

    );

    

    $this->db->update('orders', $arrUpdateOrder, array('id' => $id));

    

    $this->session->set_flashdata('success', 'Pesanan anda diproses!');

    

    redirect(base_url().'users');

    }

#### 3. class Menu
**Digunakan untuk me load model yang dibutuhkan untuk menjalankan menu**
    public function __construct()

    {

    parent::__construct();

    $this->load->model('M_Menu');

    }

**Digunakan untuk menampilkan halaman menu**
    public function index()
    {

    // get foods data

    $foods = $this->M_Menu->getFoods();

    

    // get drinks data

    $drinks = $this->M_Menu->getDrinks();

    

    // get snacks data

    $snacks = $this->M_Menu->getSnacks();

    $arrayMenus = array(

    'foods' => $foods,

    'drinks' => $drinks,

    'snacks' => $snacks

    );

    

    $data['title'] = 'Menus';

    $this->load->view('templates/header_user', $data);

    $this->load->view('menu/index', $arrayMenus);

    // $this->load->view('templates/footer');

    }

**Digunakan untuk mencari menu**

    public function search()

    {

    $search = $this->input->post('search');

    

    $menus = $this->M_Menu->getAllMenu($search);

    

    $arrayMenus = array(

    'menus' => $menus,

    'search' => $search

    );

    

    $data['title'] = 'Menus | Search';

    $this->load->view('templates/header_user', $data);

    $this->load->view('menu/search', $arrayMenus);

    }

    }

#### 4.  class Home
**digunakan untuk menjalankan halaman index home.**

    public function index()

    {

    $data['title'] = 'Home Page';

    $this->load->view('templates/header', $data);

    $this->load->view('foodHome/index');

    $this->load->view('templates/footer');

    }

#### 5. class Users
**digunakan untuk menjalankan halaman index saat pengguna sukses login.**

    public function index() {

    $data['title'] = 'Home Page';

    $data['users'] = $this->db->get_where('users',

    [ 'email' => $this->session->userdata('email') ]

    ) -> row_array();

    $this->load->view('templates/header_user', $data);

    $this->load->view('foodpageUser/index');

    $this->load->view('templates/footer');

    }

  

**digunakan untuk menjalankan tampilan profile pengguna.**

    public function profile() {

    $data['title'] = 'Profil Saya';

    $data['users'] = $this->db->get_where('users',

    [ 'email' => $this->session->userdata('email') ]

    ) -> row_array();

    $this->load->view('templates/header_user', $data);

    $this->load->view('users/profile');

    $this->load->view('templates/footer');

    

    }

**digunakan untuk menjalankan tampilan dan fungsi untuk mengedit data pengguna.**

    public function update() {

    $data['title'] = 'Update Profil';

    $data['users'] = $this->db->get_where('users',

    [ 'email' => $this->session->userdata('email') ]

    ) -> row_array();

    

    $this->form_validation->set_rules('namadepan', 'Nama Depan', 'required|trim');

    $this->form_validation->set_rules('namabelakang', 'Nama Belakang', 'required|trim');

    $this->form_validation->set_rules('nohp', 'No HP', 'required|trim');

    $this->form_validation->set_rules('alamat', 'Alamat', 'required|trim');

    

    if ($this->form_validation->run() == FALSE) {

    $this->load->view('templates/header_user', $data);

    $this->load->view('users/update', $data);

    $this->load->view('templates/footer');

    }

    else {

    $namadepan = $this->input->post('namadepan');

    $email = $this->input->post('email');

    

    // cek jika user mengupload foto profil baru

    $upload_photo = $_FILES['image'];

    

    // cek jika yang dikirim user adalah benar-benar file foto

    if ($upload_photo) {

    $config['allowed_types'] = 'gif|jpg|png';

    $config['max_size'] = '2048';

    $config['upload_path'] = './assets/images/profile';

    

    $this->load->library('upload', $config);

    

    // cek apakah gambar yang diupload berhasil?

    if ($this->upload->do_upload('image')) {

    // tumpuk file photo lama menjadi terbaru

    $old_photo = $data['users']['image'];

    if ($old_photo != 'default.jpg') {

    unlink(FCPATH . 'assets/images/profile' . $old_photo);

    }

    // ambil nama file terbaru, kemudian masukkan ke database

    $new_photo = $this->upload->data('file_name');

    $this->db->set('image', $new_photo);

    }

    // jika gagal upload gambar

    else {

    echo $this->upload->display_errors();

    }

    }

    

    $this->db->set('namadepan', $namadepan);

    $this->db->where('email', $email);

    $this->db->update('users');

    

    // membuat pesan berhasil melakukan update

    $this->session->set_flashdata(

    'message',

    '<div class="alert alert-success" role="alert">

    Akun Anda berhasil diupdate.

    </div>'

    );

    // redirect ke auth login page setelah melakukan register

    redirect('users/profile');

    }

    }



### Kode Inti Untuk Sisi Admin
#### 1. Class Superadmin
**Digunakan untuk menampilkan halaman index Superadmin.**

    public function index()

    {

    $queryAllAdmin = $this->M_Superadmin->getDataAdmin();

    

    // Jika bukan superadmin, tidak boleh masuk

    if ($this->session->userdata('role_id') != 3) {

    echo 'Not Authorized';

    }

    else {

    $DATA = array('queryAllAdmin' => $queryAllAdmin);

    

    $this->load->view('admin/superadmin.php', $DATA);

    }

    

    }

  

**Digunakan untuk menambah admin baru.**

    public function addAdminFunc()

    {

    // $id = $this->input->post('id');

    $namadepan = $this->input->post('namadepan');

    $namabelakang = $this->input->post('namabelakang');

    $email = $this->input->post('email');

    $image = $this->input->post('image');

    $password = password_hash($this->input->post('password'), PASSWORD_DEFAULT);

    $nohp = $this->input->post('nohp');

    $alamat = $this->input->post('alamat');

    $role_id = 1;

    $is_active = 1;

    $created_at = time();

    

    $arrInsert = array(

    // 'id' => $id, auto increment

    'namadepan' => $namadepan,

    'namabelakang' => $namabelakang,

    'email' => $email,

    'image' => $image,

    'password' => $password,

    'nohp' => $nohp,

    'alamat' => $alamat,

    'role_id' => $role_id,

    'is_active' => $is_active,

    'created_at' => $created_at,

    );

    

    $this->M_Superadmin->insertDataAdmin($arrInsert);

    redirect(base_url('admin/Superadmin'));

    }

  

**Digunakan untuk mengedit data admin**

    public function updateAdminFunc()

    {

    $id = $this->input->post('id');

    $namadepan = $this->input->post('namadepan');

    $namabelakang = $this->input->post('namabelakang');

    $email = $this->input->post('email');

    $image = $this->input->post('image');

    $password = password_hash($this->input->post('password'), PASSWORD_DEFAULT);

    $nohp = $this->input->post('nohp');

    $alamat = $this->input->post('alamat');

    $role_id = 1;

    $is_active = 1;

    $created_at = time();

    $arrUpdate = array(

    'namadepan' => $namadepan,

    'namabelakang' => $namabelakang,

    'email' => $email,

    'image' => $image,

    'password' => $password,

    'nohp' => $nohp,

    'alamat' => $alamat,

    'role_id' => $role_id,

    'is_active' => $is_active,

    'created_at' => $created_at

    );

    

    $this->M_Superadmin->updateDataAdmin($id, $arrUpdate);

    redirect(base_url('admin/Superadmin'));

    }

  

**Digunakan untuk menghapus data admin**

    public function deleteAdminFunc($id)

    {

    $this->M_Superadmin->deleteDataAdmin($id);

    redirect(base_url('admin/Superadmin'));

    }

#### 2. Class Menus
**Digunakan untuk menampilkan halaman index pengolahan menu**

    public function index()

    {

    $queryAllMenus = $this->M_Menu->getAllMenu('');

    

    $DATA = array('queryAllMenus' => $queryAllMenus);

    

    $this->load->view('admin/menus.php', $DATA);

    }

  

**Digunakan untuk menambah data menu**

    public function addMenusFunc()

    {

    // $id = $this->input->post('id');

    $name = $this->input->post('name');

    $type = $this->input->post('type');

    $price = $this->input->post('price');

    $image = $this->input->post('image');

    $created_at = $this->input->post('created_at');

    $updated_at = $this->input->post('created_at'); # sama dengan created_at karena pertama kali dibuat

    

    $arrInsert = array(

    // 'id' => $id, auto increment

    'name' => $name,

    'type' => $type,

    'price' => $price,

    'image' => $image,

    'created_at' => $created_at,

    'updated_at' => $updated_at

    );

    

    $this->M_Menu->insertDataMenus($arrInsert);

    redirect(base_url('admin/Menus'));

    }

  

**Digunakan untuk mengedit data menu**

    public function updateMenusFunc()

    {

    $id = $this->input->post('id');

    $name = $this->input->post('name');

    $type = $this->input->post('type');

    $price = $this->input->post('price');

    $image = $this->input->post('image');

    $created_at = $this->input->post('created_at');

    $updated_at = $this->input->post('updated_at');

    

    $arrUpdate = array(

    'name' => $name,

    'type' => $type,

    'price' => $price,

    'image' => $image,

    // 'created_at' => $created_at, Tidak diupdate

    'updated_at' => $updated_at

    );

    

    $this->M_Menu->updateDataMenus($id, $arrUpdate);

    redirect(base_url('admin/Menus'));

    }

  

**Digunakan untuk menghapus data menu**

    public function deleteMenusFunc($id)

    {

    $this->M_Menu->deleteDataMenus($id);

    redirect(base_url('admin/Menus'));

    }

#### 3. Class Order
**Digunakan untuk menampilkan halaman index Orders**

    public function index()

    {

    $queryAllOrders = $this->M_Order->getAllOrder();

    $queryOrderDetail = $this->M_Order_Detail->getAllOrderDetail();

    

    $DATA = array(

    'queryAllOrders' => $queryAllOrders,

    'queryOrderDetail' => $queryOrderDetail

    );

    

    $this->load->view('admin/orders.php', $DATA);

    }

  

**Digunakan untuk mengupdate status pesanan**

    public function updateOrdersFunc()

    {

    $id = $this->input->post('id');

    $status = $this->input->post('status');

    $arrUpdate = array(

    'status' => $status

    );

    

    $this->M_Order->updateDataOrders($id, $arrUpdate);

    redirect(base_url('admin/Orders'));

    }
